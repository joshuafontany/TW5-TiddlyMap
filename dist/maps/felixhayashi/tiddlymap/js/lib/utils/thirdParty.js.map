{"version":3,"sources":["felixhayashi/tiddlymap/js/lib/utils/thirdParty.js"],"names":["Object","defineProperty","exports","value","generateDraftTitle","title","c","draftTitle","$tw","wiki","tiddlerExists","makeDraftTiddler","targetTitle","findDraft","getTiddler","tiddler","draftTiddler","Tiddler","draft.title","draft.of","getModificationFields","addTiddler","getFullScreenApis","d","document","db","body","result","_requestFullscreen","webkitRequestFullscreen","undefined","mozRequestFullScreen","msRequestFullscreen","requestFullscreen","_exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen","exitFullscreen","_fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","fullscreenElement","_fullscreenChange","flatten","target","opts","arguments","length","delimiter","prefix","output","step","object","prev","keys","forEach","key","isarray","safe","Array","isArray","type","prototype","toString","call","isobject","newKey","unflatten","getkey","parsedKey","Number","isNaN","indexOf","split","key1","shift","key2","recipient","genUUID","CHARS","chars","uuid","rnd","r","i","Math","random","join"],"mappings":"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","file":"../../../../../../felixhayashi/tiddlymap/js/lib/utils/thirdParty.js","sourcesContent":["/* @preserve TW-Guard */\n/*\\\n\ntitle: $:/plugins/felixhayashi/tiddlymap/js/lib/utils/thirdParty\ntype: application/javascript\nmodule-type: library\n\n@preserve\n\n\\*/\n/* @preserve TW-Guard */\n\n/**\n * Modified TW-Code from Navigator widget\n * https://github.com/Jermolene/TiddlyWiki5/blob/master/core/modules/widgets/navigator.js\n */\nexport const generateDraftTitle = title => {\n\n  let c = 0,\n    draftTitle;\n  do {\n    draftTitle = 'Draft ' + (c ? (c + 1) + ' ' : '') + 'of \\'' + title + '\\'';\n    c++;\n  } while ($tw.wiki.tiddlerExists(draftTitle));\n  return draftTitle;\n\n};\n\n/**\n * Modified TW-Code from Navigator widget\n * https://github.com/Jermolene/TiddlyWiki5/blob/master/core/modules/widgets/navigator.js\n */\nexport const makeDraftTiddler = targetTitle => {\n\n  // See if there is already a draft tiddler for this tiddler\n  let draftTitle = $tw.wiki.findDraft(targetTitle);\n  if (draftTitle) {\n    return $tw.wiki.getTiddler(draftTitle);\n  }\n  // Get the current value of the tiddler we're editing\n  const tiddler = $tw.wiki.getTiddler(targetTitle);\n  // Save the initial value of the draft tiddler\n  draftTitle = generateDraftTitle(targetTitle);\n  const draftTiddler = new $tw.Tiddler(\n      tiddler,\n    {\n      title: draftTitle,\n      'draft.title': targetTitle,\n      'draft.of': targetTitle\n    },\n      $tw.wiki.getModificationFields()\n  );\n  $tw.wiki.addTiddler(draftTiddler);\n  return draftTiddler;\n\n};\n\n/**\n * TW-Code\n * @deprecated delete this in 2016 and use $tw.utils.getFullScreenApis instead\n */\nexport const getFullScreenApis = () => {\n\n  const d = document,\n    db = d.body,\n    result = {\n      '_requestFullscreen': db.webkitRequestFullscreen !== undefined ? 'webkitRequestFullscreen' :\n              db.mozRequestFullScreen !== undefined ? 'mozRequestFullScreen' :\n              db.msRequestFullscreen !== undefined ? 'msRequestFullscreen' :\n              db.requestFullscreen !== undefined ? 'requestFullscreen' : '',\n      '_exitFullscreen': d.webkitExitFullscreen !== undefined ? 'webkitExitFullscreen' :\n              d.mozCancelFullScreen !== undefined ? 'mozCancelFullScreen' :\n              d.msExitFullscreen !== undefined ? 'msExitFullscreen' :\n              d.exitFullscreen !== undefined ? 'exitFullscreen' : '',\n      '_fullscreenElement': d.webkitFullscreenElement !== undefined ? 'webkitFullscreenElement' :\n              d.mozFullScreenElement !== undefined ? 'mozFullScreenElement' :\n              d.msFullscreenElement !== undefined ? 'msFullscreenElement' :\n              d.fullscreenElement !== undefined ? 'fullscreenElement' : '',\n      '_fullscreenChange': d.webkitFullscreenElement !== undefined ? 'webkitfullscreenchange' :\n              d.mozFullScreenElement !== undefined ? 'mozfullscreenchange' :\n              d.msFullscreenElement !== undefined ? 'MSFullscreenChange' :\n              d.fullscreenElement !== undefined ? 'fullscreenchange' : ''\n    };\n  if (!result._requestFullscreen || !result._exitFullscreen || !result._fullscreenElement) {\n    return null;\n  } else {\n    return result;\n  }\n\n};\n\n/**\n *\n * Slightly modified by me to allow an optional prefix.\n *\n * For the original code:\n *\n * Copyright (c) 2014, Hugh Kennedy, All rights reserved.\n * Code published under the BSD 3-Clause License\n *\n * @see oringal repo https://github.com/hughsk/flat\n * @see snapshot https://github.com/felixhayashi/flat\n * @see http://opensource.org/licenses/BSD-3-Clause\n */\nexport const flatten = (target, opts = {}) => {\n\n  var delimiter = opts.delimiter || '.';\n  var prefix = opts.prefix || '';\n  var output = {};\n\n  function step(object, prev) {\n    Object.keys(object).forEach(function(key) {\n      var value = object[key];\n      var isarray = opts.safe && Array.isArray(value);\n      var type = Object.prototype.toString.call(value);\n      var isobject = (\n        type === '[object Object]' ||\n        type === '[object Array]'\n      );\n\n      var newKey = prev\n        ? prev + delimiter + key\n        : prefix + key;\n\n      if (!isarray && isobject) {\n        return step(value, newKey);\n      }\n\n      output[newKey] = value;\n    });\n  }\n\n  step(target);\n\n  return output;\n\n};\n\n\n/**\n * Copyright (c) 2014, Hugh Kennedy, All rights reserved.\n * Code published under the BSD 3-Clause License\n *\n * @see oringal repo https://github.com/hughsk/flat\n * @see snapshot https://github.com/felixhayashi/flat\n * @see http://opensource.org/licenses/BSD-3-Clause\n */\nexport const unflatten = (target, opts = {}) => {\n\n  var delimiter = opts.delimiter || '.';\n  var result = {};\n\n  if (Object.prototype.toString.call(target) !== '[object Object]') {\n    return target;\n  }\n\n  // safely ensure that the key is\n  // an integer.\n  function getkey(key) {\n    var parsedKey = Number(key);\n\n    return (\n      isNaN(parsedKey) ||\n      key.indexOf('.') !== -1\n    ) ? key\n      : parsedKey;\n  }\n\n  Object.keys(target).forEach(function(key) {\n    var split = key.split(delimiter);\n    var key1 = getkey(split.shift());\n    var key2 = getkey(split[0]);\n    var recipient = result;\n\n    while (key2 !== undefined) {\n      if (recipient[key1] === undefined) {\n        recipient[key1] = (\n          typeof key2 === 'number' &&\n          !opts.object ? [] : {}\n        );\n      }\n\n      recipient = recipient[key1];\n      if (split.length > 0) {\n        key1 = getkey(split.shift());\n        key2 = getkey(split[0]);\n      }\n    }\n\n    // unflatten again for 'messy objects'\n    recipient[key1] = unflatten(target[key], opts);\n  });\n\n  return result;\n\n};\n\n\n/**\n * An adopted version of pmario's version to create\n * uuids of type RFC4122, version 4 ID.\n *\n * Shortened version:\n * pmario (1.0 - 2011.05.22):\n * http://chat-plugins.tiddlyspace.com/#UUIDPlugin\n *\n * Original version:\n * Math.uuid.js (v1.4)\n * http://www.broofa.com\n * mailto:robert@broofa.com\n *\n * Copyright (c) 2010 Robert Kieffer\n * Dual licensed under the MIT and GPL licenses.\n *\n * ---\n * @see https://github.com/almende/vis/issues/432\n*/\nexport const genUUID = (function() {\n\n  // Private array of chars to use\n  var CHARS = '0123456789abcdefghijklmnopqrstuvwxyz'.split('');\n\n  return function () {\n    var chars = CHARS, uuid = new Array(36);\n\n    var rnd=0, r;\n    for (var i = 0; i < 36; i++) {\n      if (i==8 || i==13 ||  i==18 || i==23) {\n        uuid[i] = '-';\n      } else if (i==14) {\n        uuid[i] = '4';\n      } else {\n        if (rnd <= 0x02) rnd = 0x2000000 + (Math.random()*0x1000000)|0;\n        r = rnd & 0xf;\n        rnd = rnd >> 4;\n        uuid[i] = chars[(i == 19) ? (r & 0x3) | 0x8 : r];\n      }\n    }\n\n    return uuid.join('');\n  };\n\n})();\n"],"sourceRoot":"../../../../../../../src/plugins"}